{"version":3,"sources":["services/upload.babel.js"],"names":[],"mappings":";;;;;AAAA,IAAI,WAAW,OAAO,QAAtB;;AAEA,OAAO,MAAP,GAAgB;AACd,aAAS;;AADK,CAAhB;;;;;;;;;;;;AAgBE,SAAS,UAAT,CAAoB,GAApB,EAAyB,MAAzB,EAAgC;AAC9B,QAAI,WAAW,IAAI,MAAM,QAAV,CAAmB;AAChC,kBAAU,mBADsB,E;AAEhC,yBAAiB,IAAI,aAAJ,IAAqB,QAFN,E;AAGhC,uBAAe,OAAO,OAAP,GAAiB,cAHA;;;;;;;;AAWhC,gBAAQ,wCAXwB;;AAahC,mBAAW,IAAI,SAAJ,IAAiB,WAbI,E;AAchC,yBAAiB,OAde,E;AAehC,yBAAiB,oCAfe,E;AAgBhC,uBAAe,CAhBiB,E;AAiBhC,kBAAU,IAjBsB,E;AAkBhC,wBAAgB,IAAI,YAAJ,IAAoB,aAlBJ,E;AAmBhC,sBAAc,KAnBkB,E;AAoBhC,sBAAc,IApBkB,E;AAqBhC,cAAM;AACF,0BAAc,oBAAS,EAAT,EAAa,KAAb,EAAoB;AAC9B,yBAAS,IAAT,CAAc,KAAd,EAAqB,UAAS,IAAT,EAAe;;;AAGnC,iBAHD;AAIH,aANC;AAOF,4BAAgB,sBAAS,EAAT,EAAa,IAAb,EAAmB;AAC/B,wBAAQ,GAAR,CAAY,IAAZ;;AAEH,aAVC;AAWF,8BAAkB,wBAAS,EAAT,EAAa,IAAb,EAAmB;;AAEpC,aAbC;AAcF,4BAAgB,sBAAS,EAAT,EAAa,IAAb,EAAmB,IAAnB,EAAyB;;;;;;;;;;;AAWxC,aAzBC;AA0BF,qBAAS,eAAS,EAAT,EAAa,GAAb,EAAkB,MAAlB,EAA0B;;AAElC,aA5BC;AA6BF,8BAAkB,0BAAW;;AAE5B,aA/BC;AAgCF,mBAAO,aAAS,EAAT,EAAa,IAAb,EAAmB;;;;;;;AAOtB,uBAAO,OAAO,EAAP,EAAW,IAAX,CAAP;AACH;AAxCC;AArB0B,KAAnB,CAAf;AAgEA,WAAO,QAAP;AACD;;kBAEY,U","file":"services/upload.babel.js","sourcesContent":["var plupload = window.plupload;\n\nwindow.CONFIG = {\n  APIROOT: 'http://localhost:1234/api'\n    // APIROOT: 'http://zhanglun.daoapp.io/api'\n};\n\n\n/**\n * 初始化上传组件\n * @param  {Object} opt\n * {\n * \tbrowse_button: 'browse',\n * \tdrop_element: 'taskInputer',\n * \tcontainer: 'container'\n * }\n * @return {[type]}     [description]\n */\n  function uploadInit(opt, setkey){\n    var uploader = new Qiniu.uploader({\n      runtimes: 'html5,flash,html4',    //上传模式,依次退化\n      'browse_button': opt.browse_button || 'browse',       //上传选择的点选按钮，**必需**\n      'uptoken_url': CONFIG.APIROOT + '/qiniu/token',\n          //Ajax请求upToken的Url，**强烈建议设置**（服务端提供）\n      // uptoken : '<Your upload token>',\n          //若未指定uptoken_url,则必须指定 uptoken ,uptoken由其他程序生成\n      // unique_names: true,\n          // 默认 false，key为文件名。若开启该选项，SDK会为每个文件自动生成key（文件名）\n      // save_key: true,\n          // 默认 false。若在服务端生成uptoken的上传策略中指定了 `sava_key`，则开启，SDK在前端将不对key进行任何处理\n      domain: 'http://7i7gl0.com1.z0.glb.clouddn.com/',\n          //bucket 域名，下载资源时用到，**必需**\n      container: opt.container || 'container',           //上传区域DOM ID，默认是browser_button的父元素，\n      'max_file_size': '100mb',           //最大文件体积限制\n      'flash_swf_url': 'vendor/plupload-2.1.8/js/Moxie.swf',  //引入flash,相对路径\n      'max_retries': 3,                   //上传失败最大重试次数\n      dragdrop: true,                   //开启可拖曳上传\n      'drop_element': opt.drop_element || 'taskInputer',        //拖曳上传区域元素的ID，拖曳文件或文件夹后可触发上传\n      'chunk_size': '4mb',                //分块上传时，每片的体积\n      'auto_start': true,                 //选择文件后自动上传，若关闭需要自己绑定事件触发上传,\n      init: {\n          'FilesAdded': function(up, files) {\n              plupload.each(files, function(file) {\n                  // 文件添加进队列后,处理相关的事情\n                //   console.log(file);\n              });\n          },\n          'BeforeUpload': function(up, file) {\n              console.log(file);\n                 // 每个文件上传前,处理相关的事情\n          },\n          'UploadProgress': function(up, file) {\n                 // 每个文件上传时,处理相关的事情\n          },\n          'FileUploaded': function(up, file, info) {\n                 // 每个文件上传成功后,处理相关的事情\n                 // 其中 info 是文件上传成功后，服务端返回的json，形式如\n                 // {\n                 //    \"hash\": \"Fh8xVqod2MQ1mocfI4S4KpRL6D98\",\n                 //    \"key\": \"gogopher.jpg\"\n                 //  }\n                 // 参考http://developer.qiniu.com/docs/v6/api/overview/up/response/simple-response.html\n                 // var domain = up.getOption('domain');\n                 // var res = parseJSON(info);\n                 // var sourceLink = domain + res.key; 获取上传成功后的文件的Url\n          },\n          'Error': function(up, err, errTip) {\n                 //上传出错时,处理相关的事情\n          },\n          'UploadComplete': function() {\n                 //队列文件处理完毕后,处理相关的事情\n          },\n          'Key': function(up, file) {\n              // 若想在前端对每个文件的key进行个性化处理，可以配置该函数\n              // 该配置必须要在 unique_names: false , save_key: false 时才生效\n              // var key = \"\";\n              // do something with key here\n              //   return 'test_prefixer_hahhahah_______' + file.name;\n              // return window.account.username + '/' + file.name;\n              return setkey(up, file);\n          }\n      }\n    });\n    return uploader;\n  }\n\nexport default uploadInit;\n"],"sourceRoot":"/source/"}