{"version":3,"sources":["src/services/upload.babel.js"],"names":[],"mappings":";;;;;AAAA,IAAI,WAAW,OAAO,QAAtB;;AAEA,OAAO,MAAP,GAAgB;AACd,aAAS;;AADK,CAAhB;;;;;;;;;;;;AAgBE,SAAS,UAAT,CAAoB,GAApB,EAAyB,MAAzB,EAAgC;AAC9B,QAAI,WAAW,IAAI,MAAM,QAAV,CAAmB;AAChC,kBAAU,mBADsB,E;AAEhC,yBAAiB,IAAI,aAAJ,IAAqB,QAFN,E;AAGhC,uBAAe,OAAO,OAAP,GAAiB,cAHA;;;;;;;;AAWhC,gBAAQ,wCAXwB;;AAahC,mBAAW,IAAI,SAAJ,IAAiB,WAbI,E;AAchC,yBAAiB,OAde,E;AAehC,yBAAiB,oCAfe,E;AAgBhC,uBAAe,CAhBiB,E;AAiBhC,kBAAU,IAjBsB,E;AAkBhC,wBAAgB,IAAI,YAAJ,IAAoB,aAlBJ,E;AAmBhC,sBAAc,KAnBkB,E;AAoBhC,sBAAc,IApBkB,E;AAqBhC,cAAM;AACF,0BAAc,oBAAS,EAAT,EAAa,KAAb,EAAoB;AAC9B,yBAAS,IAAT,CAAc,KAAd,EAAqB,UAAS,IAAT,EAAe;;;AAGnC,iBAHD;AAIH,aANC;AAOF,4BAAgB,sBAAS,EAAT,EAAa,IAAb,EAAmB;AAC/B,wBAAQ,GAAR,CAAY,IAAZ;;AAEH,aAVC;AAWF,8BAAkB,wBAAS,EAAT,EAAa,IAAb,EAAmB;;AAEpC,aAbC;AAcF,4BAAgB,sBAAS,EAAT,EAAa,IAAb,EAAmB,IAAnB,EAAyB;;;;;;;;;;;AAWxC,aAzBC;AA0BF,qBAAS,eAAS,EAAT,EAAa,GAAb,EAAkB,MAAlB,EAA0B;;AAElC,aA5BC;AA6BF,8BAAkB,0BAAW;;AAE5B,aA/BC;AAgCF,mBAAO,aAAS,EAAT,EAAa,IAAb,EAAmB;;;;;;;AAOtB,uBAAO,OAAO,EAAP,EAAW,IAAX,CAAP;AACH;AAxCC;AArB0B,KAAnB,CAAf;AAgEA,WAAO,QAAP;AACD;;kBAEY,U","file":"src/services/upload.babel.js","sourcesContent":["var plupload = window.plupload;\r\n\r\nwindow.CONFIG = {\r\n  APIROOT: 'http://localhost:1234/api'\r\n    // APIROOT: 'http://zhanglun.daoapp.io/api'\r\n};\r\n\r\n\r\n/**\r\n * 初始化上传组件\r\n * @param  {Object} opt\r\n * {\r\n * \tbrowse_button: 'browse',\r\n * \tdrop_element: 'taskInputer',\r\n * \tcontainer: 'container'\r\n * }\r\n * @return {[type]}     [description]\r\n */\r\n  function uploadInit(opt, setkey){\r\n    var uploader = new Qiniu.uploader({\r\n      runtimes: 'html5,flash,html4',    //上传模式,依次退化\r\n      'browse_button': opt.browse_button || 'browse',       //上传选择的点选按钮，**必需**\r\n      'uptoken_url': CONFIG.APIROOT + '/qiniu/token',\r\n          //Ajax请求upToken的Url，**强烈建议设置**（服务端提供）\r\n      // uptoken : '<Your upload token>',\r\n          //若未指定uptoken_url,则必须指定 uptoken ,uptoken由其他程序生成\r\n      // unique_names: true,\r\n          // 默认 false，key为文件名。若开启该选项，SDK会为每个文件自动生成key（文件名）\r\n      // save_key: true,\r\n          // 默认 false。若在服务端生成uptoken的上传策略中指定了 `sava_key`，则开启，SDK在前端将不对key进行任何处理\r\n      domain: 'http://7i7gl0.com1.z0.glb.clouddn.com/',\r\n          //bucket 域名，下载资源时用到，**必需**\r\n      container: opt.container || 'container',           //上传区域DOM ID，默认是browser_button的父元素，\r\n      'max_file_size': '100mb',           //最大文件体积限制\r\n      'flash_swf_url': 'vendor/plupload-2.1.8/js/Moxie.swf',  //引入flash,相对路径\r\n      'max_retries': 3,                   //上传失败最大重试次数\r\n      dragdrop: true,                   //开启可拖曳上传\r\n      'drop_element': opt.drop_element || 'taskInputer',        //拖曳上传区域元素的ID，拖曳文件或文件夹后可触发上传\r\n      'chunk_size': '4mb',                //分块上传时，每片的体积\r\n      'auto_start': true,                 //选择文件后自动上传，若关闭需要自己绑定事件触发上传,\r\n      init: {\r\n          'FilesAdded': function(up, files) {\r\n              plupload.each(files, function(file) {\r\n                  // 文件添加进队列后,处理相关的事情\r\n                //   console.log(file);\r\n              });\r\n          },\r\n          'BeforeUpload': function(up, file) {\r\n              console.log(file);\r\n                 // 每个文件上传前,处理相关的事情\r\n          },\r\n          'UploadProgress': function(up, file) {\r\n                 // 每个文件上传时,处理相关的事情\r\n          },\r\n          'FileUploaded': function(up, file, info) {\r\n                 // 每个文件上传成功后,处理相关的事情\r\n                 // 其中 info 是文件上传成功后，服务端返回的json，形式如\r\n                 // {\r\n                 //    \"hash\": \"Fh8xVqod2MQ1mocfI4S4KpRL6D98\",\r\n                 //    \"key\": \"gogopher.jpg\"\r\n                 //  }\r\n                 // 参考http://developer.qiniu.com/docs/v6/api/overview/up/response/simple-response.html\r\n                 // var domain = up.getOption('domain');\r\n                 // var res = parseJSON(info);\r\n                 // var sourceLink = domain + res.key; 获取上传成功后的文件的Url\r\n          },\r\n          'Error': function(up, err, errTip) {\r\n                 //上传出错时,处理相关的事情\r\n          },\r\n          'UploadComplete': function() {\r\n                 //队列文件处理完毕后,处理相关的事情\r\n          },\r\n          'Key': function(up, file) {\r\n              // 若想在前端对每个文件的key进行个性化处理，可以配置该函数\r\n              // 该配置必须要在 unique_names: false , save_key: false 时才生效\r\n              // var key = \"\";\r\n              // do something with key here\r\n              //   return 'test_prefixer_hahhahah_______' + file.name;\r\n              // return window.account.username + '/' + file.name;\r\n              return setkey(up, file);\r\n          }\r\n      }\r\n    });\r\n    return uploader;\r\n  }\r\n\r\nexport default uploadInit;\r\n"],"sourceRoot":"/source/"}